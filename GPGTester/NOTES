This doesn't work completely okay, but it is a starting point.